<!DOCTYPE html>
<html>
<head>

	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Daily Expense Tracker - Dashboard</title>
	<link href="{{ url_for('static', filename='css/bootstrap.min.css') }}" rel="stylesheet">
	<link href="{{ url_for('static', filename='css/font-awesome.min.css') }}" rel="stylesheet">
	<link href="{{ url_for('static', filename='css/datepicker3.css') }}" rel="stylesheet">
	<link href="{{ url_for('static', filename='css/styles.css')}}" rel="stylesheet">
	<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
	<script>
	var colorArray = ['#FF6633', '#FFB399', '#FF33FF', '#FFFF99', '#00B3E6',
											'#E6B333', '#3366E6', '#999966', '#99FF99', '#B34D4D',
											'#80B300', '#809900', '#E6B3B3', '#6680B3', '#66991A',
											'#FF99E6', '#CCFF1A', '#FF1A66', '#E6331A', '#33FFCC',
											'#66994D', '#B366CC', '#4D8000', '#B33300', '#CC80CC',
											'#66664D', '#991AFF', '#E666FF', '#4DB3FF', '#1AB399',
											'#E666B3', '#33991A', '#CC9999', '#B3B31A', '#00E680',
											'#4D8066', '#809980', '#E6FF80', '#1AFF33', '#999933',
											'#FF3380', '#CCCC00', '#66E64D', '#4D80CC', '#9900B3',
											'#E64D66', '#4DB380', '#FF4D4D', '#99E6E6', '#6666FF'];
	</script>
	<!--Custom Font-->
	<link href="https://fonts.googleapis.com/css?family=Montserrat:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">
	<!--[if lt IE 9]>
	<script src="js/html5shiv.js"></script>
	<script src="js/respond.min.js"></script>
	<![endif]-->
	<style>
	body {
		overflow: scroll;
		}</style>
</head>

<body>

	<?php include_once('includes/header.php');?>
	<?php include_once('includes/sidebar.php');?>
	<!-- header html -->
	<nav class="navbar navbar-custom navbar-fixed-top" role="navigation">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#sidebar-collapse"><span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span></button>
                <a class="navbar-brand" href="/dashboard"><span>Smart Expense Manager</span></a>

            </div>

        </div>
        <!-- /.container-fluid -->
    </nav>
		<!-- sidebarhtml -->

	<div id="sidebar-collapse" class="col-sm-3 col-lg-2 sidebar">
        <div class="profile-sidebar">
            <div class="profile-userpic">
                <img src="http://placehold.it/50/30a5ff/fff" class="img-responsive" alt="">
            </div>
            <div class="profile-usertitle">
                <?php
$uid=$_SESSION['detsuid'];
$ret=mysqli_query($con,"select FullName from tbluser where ID='$uid'");
$row=mysqli_fetch_array($ret);
$name=$row['FullName'];

?>
                <div class="profile-usertitle-name"><?php echo $name; ?></div>
                <div class="profile-usertitle-status"><span class="indicator label-success"></span>Online</div>
            </div>
            <div class="clear"></div>
        </div>
        <div class="divider"></div>

        <ul class="nav menu">
            <li class="active"><a href="/dashboard"><em class="fa fa-dashboard">&nbsp;</em> Dashboard</a></li>



            <li class="parent "><a data-toggle="collapse" href="#sub-item-1">
                <em class="fa fa-navicon">&nbsp;</em>Expenses <span data-toggle="collapse" href="#sub-item-1" class="icon pull-right"><em class="fa fa-plus"></em></span>
                </a>
                <ul class="children collapse" id="sub-item-1">
                    <li><a class="" href="/add-expense">
                        <span class="fa fa-arrow-right">&nbsp;</span> Add Expenses
                    </a></li>
                    <li><a class="" href="/manage-expense">
                        <span class="fa fa-arrow-right">&nbsp;</span> Manage Expenses
                    </a></li>

                </ul>

            </li>

  <li class="parent "><a data-toggle="collapse" href="#sub-item-2">
                <em class="fa fa-navicon">&nbsp;</em>Expense Report <span data-toggle="collapse" href="#sub-item-1" class="icon pull-right"><em class="fa fa-plus"></em></span>
                </a>
                <ul class="children collapse" id="sub-item-2">
                    <li><a class="" href="/datewise-reports">
                        <span class="fa fa-arrow-right">&nbsp;</span> Daywise Expenses
                    </a></li>
                    <li><a class="" href="/monthwise-reports">
                        <span class="fa fa-arrow-right">&nbsp;</span> Monthwise Expenses
                    </a></li>
                    <li><a class="" href="/yearwise-reports">
                        <span class="fa fa-arrow-right">&nbsp;</span> Yearwise Expenses
                    </a></li>

                </ul>
            </li>





            <li><a href="/profile"><em class="fa fa-user">&nbsp;</em> Profile</a></li>
             <li><a href="/resetpassword"><em class="fa fa-clone">&nbsp;</em> Change Password</a></li>
<li><a href="/logout"><em class="fa fa-power-off">&nbsp;</em> Logout</a></li>

        </ul>
    </div>
<!--sidebar end-->

	<div class="col-sm-9 col-sm-offset-3 col-lg-10 col-lg-offset-2 main">
		<div class="row">
			<ol class="breadcrumb">
				<li><a href="#">
					<em class="fa fa-home"></em>
				</a></li>
				<li class="active">Dashboard</li>
			</ol>
		</div><!--/.row-->

		<div class="row">
			<div class="col-lg-12">
				<h1 class="page-header">Dashboard : Welcome {{ name }}</h1>
			</div>
		</div><!--/.row-->




		<div class="row">
			<div class="col-lg-6 col-md-3">

				<div class="panel panel-default">
					<div class="panel-body easypiechart-panel style="min-height: 800px; max-height: 600px;overflow-y: scroll;"">
<?php
//Today Expense
$userid=$_SESSION['detsuid'];
$tdate=date('Y-m-d');
$query=mysqli_query($con,"select sum(ExpenseCost)  as todaysexpense from tblexpense where (ExpenseDate)='$tdate' && (UserId='$userid');");
$result=mysqli_fetch_array($query);
$sum_today_expense=$result['todaysexpense'];
 ?>

						<h4>Year's Expense</h4>

						<canvas id="myChart3"></canvas>
						<script>

						var ctx = document.getElementById('myChart3').getContext('2d');
						var plabel = {{ bar_labels|safe }}
						var pdata = {{ bar_data|safe }}
						var chart = new Chart(ctx, {
    				// The type of chart we want to create
				    type: 'bar',
						theme: 'light2',

				    // The data for our dataset

				    data: {

				        labels: plabel,
				        datasets: [{
				            label: 'Click to hide',
										backgroundColor :colorArray,
				            data: pdata
				        }]
				    },


				    // Configuration options go here
				    options: {legend : {display:false}}
				});
						</script>

					</div>
				</div>
			</div>


			<div class="col-lg-6 col-md-3">

				<div class="panel panel-default">
					<div class="panel-body easypiechart-panel style="min-height: 800px; max-height: 600px;overflow-y: scroll;"">

						<h4>Recent Transactions</h4>



					</div>
				</div>
			</div>


			<div class="col-lg-6 col-md-3">

				<div class="panel panel-default">
					<div class="panel-body easypiechart-panel style="min-height: 800px; max-height: 600px;overflow-y: scroll;"">

						<h4>This Month's Expense</h4>

						<canvas id="myChart1"></canvas>
						<script>

						var ctx = document.getElementById('myChart1').getContext('2d');
						// var plabel =
						// var pdata =
						var chart = new Chart(ctx, {
    				// The type of chart we want to create
				    type: 'pie',
						theme: 'light2',

				    // The data for our dataset
				    data: {
				        labels: {{ pie_lables|safe }},
				        datasets: [{
				            label: 'Todays Expense',
										backgroundColor :["#F7464A", "#46BFBD", "#FDB45C", "#FEDCBA","#ABCDEF", "#DDDDDD", "#ABCABC"],
				            data: {{ pie_data|safe }}
				        }]
				    },

				    // Configuration options go here
				    options: {}
				});
						</script>

					</div>
				</div>
			</div>










			<!-- <div class="col-lg-4 col-md-3">
				<div class="panel panel-default">
					<?php
//Yestreday Expense
$userid=$_SESSION['detsuid'];
$ydate=date('Y-m-d',strtotime("-1 days"));
$query1=mysqli_query($con,"select sum(ExpenseCost)  as yesterdayexpense from tblexpense where (ExpenseDate)='$ydate' && (UserId='$userid');");
$result1=mysqli_fetch_array($query1);
$sum_yesterday_expense=$result1['yesterdayexpense'];
 ?>
					<div class="panel-body easypiechart-panel">
						<h4>Yesterday's Expense</h4>
						<div class="easypiechart" id="easypiechart-orange" data-percent="<?php echo $sum_yesterday_expense;?>" ><span class="percent"><?php if($sum_yesterday_expense==""){
echo "0";
} else {
echo $sum_yesterday_expense;
}

	?></span></div>
					</div>
				</div>
			</div> -->
			<!-- <div class="col-lg-4 col-md-3">
				<div class="panel panel-default">
					<?php
//Weekly Expense
$userid=$_SESSION['detsuid'];
 $pastdate=  date("Y-m-d", strtotime("-1 week"));
$crrntdte=date("Y-m-d");
$query2=mysqli_query($con,"select sum(ExpenseCost)  as weeklyexpense from tblexpense where ((ExpenseDate) between '$pastdate' and '$crrntdte') && (UserId='$userid');");
$result2=mysqli_fetch_array($query2);
$sum_weekly_expense=$result2['weeklyexpense'];
 ?>
					<div class="panel-body easypiechart-panel">
						<h4>Last 7day's Expense</h4>
						<div class="easypiechart" id="easypiechart-teal" data-percent="<?php echo $sum_weekly_expense;?>"><span class="percent"><?php if($sum_weekly_expense==""){
echo "0";
} else {
echo $sum_weekly_expense;
}

	?></span></div>
					</div>
				</div>
			</div> -->
			<!-- <div class="col-lg-4 col-md-3">
				<div class="panel panel-default">
					<?php
//Monthly Expense
$userid=$_SESSION['detsuid'];
 $monthdate=  date("Y-m-d", strtotime("-1 month"));
$crrntdte=date("Y-m-d");
$query3=mysqli_query($con,"select sum(ExpenseCost)  as monthlyexpense from tblexpense where ((ExpenseDate) between '$monthdate' and '$crrntdte') && (UserId='$userid');");
$result3=mysqli_fetch_array($query3);
$sum_monthly_expense=$result3['monthlyexpense'];
 ?>
					<div class="panel-body easypiechart-panel">
						<h4>Last 30day's Expenses</h4>
						<div class="easypiechart" id="easypiechart-red" data-percent="<?php echo $sum_monthly_expense;?>" ><span class="percent"><?php if($sum_monthly_expense==""){
echo "0";
} else {
echo $sum_monthly_expense;
}

	?></span></div>
					</div>
				</div>
			</div> -->

		<!-- </div><!--/.row-->
			<!-- <div class="row">
			<div class="col-lg-4 col-md-3">
				<div class="panel panel-default">
					<?php
//Yearly Expense
$userid=$_SESSION['detsuid'];
 $cyear= date("Y");
$query4=mysqli_query($con,"select sum(ExpenseCost)  as yearlyexpense from tblexpense where (year(ExpenseDate)='$cyear') && (UserId='$userid');");
$result4=mysqli_fetch_array($query4);
$sum_yearly_expense=$result4['yearlyexpense'];
 ?>
					<div class="panel-body easypiechart-panel">
						<h4>Current Year Expenses</h4>
						<div class="easypiechart" id="easypiechart-red" data-percent="<?php echo $sum_yearly_expense;?>" ><span class="percent"><?php if($sum_yearly_expense==""){
echo "0";
} else {
echo $sum_yearly_expense;
}

	?></span></div>


					</div>

				</div>

			</div>

		<div class="col-lg-4 col-md-3">
				<div class="panel panel-default">
					<?php
//Yearly Expense
$userid=$_SESSION['detsuid'];
$query5=mysqli_query($con,"select sum(ExpenseCost)  as totalexpense from tblexpense where UserId='$userid';");
$result5=mysqli_fetch_array($query5);
$sum_total_expense=$result5['totalexpense'];
 ?>
					<div class="panel-body easypiechart-panel">
						<h4>Total Expenses</h4>
						<div class="easypiechart" id="easypiechart-red" data-percent="<?php echo $sum_total_expense;?>" ><span class="percent"><?php if($sum_total_expense==""){
echo "0";
} else {
echo $sum_total_expense;
}

	?></span></div>


					</div>

				</div>

			</div>


		</div> -->

		<!--/.row-->
	</div>	<!--/.main-->
	<?php include_once('includes/footer.php');?>
	<script src="{{ url_for('static',filename='js/jquery-1.11.1.min.js')}}"></script>
		<script src="{{ url_for('static',filename='js/bootstrap.min.js')}}"></script>
		<script src="{{ url_for('static',filename='js/chart.min.js')}}"></script>
		<script src="{{ url_for('static',filename='js/chart-data.js')}}"></script>
		<script src="{{ url_for('static',filename='js/easypiechart.js')}}"></script>
		<script src="{{ url_for('static',filename='js/easypiechart-data.js')}}"></script>
		<script src="{{ url_for('static',filename='js/bootstrap-datepicker.js')}}"></script>
		<script src="{{ url_for('static',filename='js/custom.js')}}"></script>

	<script>
		window.onload = function () {
	var chart1 = document.getElementById("line-chart").getContext("2d");
	window.myLine = new Chart(chart1).Line(lineChartData, {
	responsive: true,
	scaleLineColor: "rgba(0,0,0,.2)",
	scaleGridLineColor: "rgba(0,0,0,.05)",
	scaleFontColor: "#c5c7cc"
	});
};
	</script>

</body>
</html>
<?php } ?>
